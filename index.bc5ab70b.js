!function(){function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}function t(t,r){if(t){if("string"==typeof t)return e(t,r);var a=Object.prototype.toString.call(t).slice(8,-1);if("Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a)return Array.from(a);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return e(t,r)}}var r=new(function(){var r;function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,a),this.board=e,this.score=0,this.status="idle"}return r=[{key:"start",value:function(){if("idle"===this.status){this.status="playing",this.addRandomTile(),this.addRandomTile(),this.render();var e=document.querySelector(".button");e&&(e.textContent="Restart")}}},{key:"restart",value:function(){this.hideMessage(),this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle";var e=document.querySelector(".game-score");e&&(e.textContent=this.score),this.render()}},{key:"moveLeft",value:function(){if("playing"===this.status){for(var e=0,t=!1,r=0;r<4;r++){var a=this.slideAndMerge(this.board[r]),n=a.newRow,o=a.points;a.changed&&(this.board[r]=n,e+=o,t=!0)}t&&(this.addRandomTile(),this.render(),this.updateScore(e),this.checkGameOver())}}},{key:"moveRight",value:function(){if("playing"===this.status){for(var r=0,a=!1,n=0;n<4;n++){var o,s=((function(t){if(Array.isArray(t))return e(t)})(o=this.board[n])||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||t(o)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).reverse(),i=this.slideAndMerge(s),u=i.newRow,l=i.points;i.changed&&(this.board[n]=u.reverse(),r+=l,a=!0)}a&&(this.addRandomTile(),this.render(),this.updateScore(r),this.checkGameOver())}}},{key:"moveUp",value:function(){if("playing"===this.status){for(var e=0,t=!1,r=0;r<4;r++){for(var a=[],n=0;n<4;n++)a.push(this.board[n][r]);var o=this.slideAndMerge(a),s=o.newRow,i=o.points;if(o.changed){e+=i,t=!0;for(var u=0;u<4;u++)this.board[u][r]=s[u]}}t&&(this.addRandomTile(),this.render(),this.updateScore(e),this.checkGameOver())}}},{key:"moveDown",value:function(){if("playing"===this.status){for(var e=0,t=!1,r=0;r<4;r++){for(var a=[],n=3;n>=0;n--)a.push(this.board[n][r]);var o=this.slideAndMerge(a),s=o.newRow,i=o.points;if(o.changed){e+=i,t=!0;for(var u=0;u<4;u++)this.board[3-u][r]=s[u]}}t&&(this.addRandomTile(),this.render(),this.updateScore(e),this.checkGameOver())}}},{key:"updateScore",value:function(e){this.score+=e;var t=document.querySelector(".game-score");t&&(t.textContent=this.score)}},{key:"transposeBoard",value:function(){for(var e=[],t=0;t<this.board[0].length;t++){for(var r=[],a=0;a<this.board.length;a++)r.push(this.board[a][t]);e.push(r)}this.board=e}},{key:"addRandomTile",value:function(){for(var e=[],r=0;r<4;r++)for(var a=0;a<4;a++)0===this.board[r][a]&&e.push([r,a]);if(0!==e.length){var n,o=function(e){if(Array.isArray(e))return e}(n=e[Math.floor(Math.random()*e.length)])||function(e,t){var r,a,n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o=[],s=!0,i=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),2!==o.length);s=!0);}catch(e){i=!0,a=e}finally{try{s||null==n.return||n.return()}finally{if(i)throw a}}return o}}(n,2)||t(n,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),s=o[0],i=o[1];this.board[s][i]=.9>Math.random()?2:4,this.board.flat().includes(2048)&&(this.status="win",this.showMessage("You won!")),this.checkGameOver()}}},{key:"slideAndMerge",value:function(e){for(var t=e.filter(function(e){return 0!==e}),r=0,a=!1,n=0;n<t.length-1;n++)t[n]===t[n+1]&&(t[n]*=2,r+=t[n],t.splice(n+1,1),a=!0);for(;t.length<4;)t.push(0);return t.join("")!==e.join("")&&(a=!0),{newRow:t,points:r,changed:a}}},{key:"isGameOver",value:function(){for(var e=0;e<4;e++)for(var t=0;t<4;t++)if(0===this.board[e][t]||t<3&&this.board[e][t]===this.board[e][t+1]||e<3&&this.board[e][t]===this.board[e+1][t])return!1;return!0}},{key:"checkGameOver",value:function(){!0===this.isGameOver()&&(this.status="lose",this.showMessage("Game Over!"))}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){return this.status}},{key:"render",value:function(){for(var e=document.querySelectorAll(".field-cell"),t=0,r=0;r<4;r++)for(var a=0;a<4;a++){var n=e[t],o=this.board[r][a];n&&(n.innerHTML=o||"",n.className="field-cell ".concat(o?"field-cell--".concat(o):""),t++)}}},{key:"showMessage",value:function(e){var t=document.querySelector(".game-message");t&&(t.textContent=e,t.style.display="block")}},{key:"hideMessage",value:function(){var e=document.querySelector(".game-message");e&&(e.style.display="none")}}],function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(a.prototype,r),a}()),a=document.querySelector(".button"),n=document.querySelector(".message-container"),o=document.querySelector(".message-lose"),s=document.querySelector(".message-win"),i=document.querySelector(".message-start");function u(e){n.classList.remove("hidden"),o.classList.add("hidden"),s.classList.add("hidden"),i.classList.add("hidden"),"lose"===e?o.classList.remove("hidden"):"win"===e?s.classList.remove("hidden"):"start"===e&&i.classList.remove("hidden")}a.addEventListener("click",function(){"idle"===r.status?(r.start(),u("start"),a.classList.remove("start"),a.classList.add("restart"),a.textContent="Restart",i.textContent='Press "Restart" to start the new Game'):confirm("Хотите начать новую игру?")&&(r.restart(),r.start(),u("start"),a.textContent="Restart")}),document.addEventListener("keydown",function(e){if("playing"===r.status)switch(e.key){case"ArrowLeft":r.moveLeft();break;case"ArrowRight":r.moveRight();break;case"ArrowUp":r.moveUp();break;case"ArrowDown":r.moveDown()}r.isGameOver()?u("lose"):"win"===r.status&&u("win")})}();
//# sourceMappingURL=index.bc5ab70b.js.map
